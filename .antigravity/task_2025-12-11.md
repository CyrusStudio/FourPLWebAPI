# SAP 整合中間件 API - 任務清單

## Phase 1: 專案初始化與結構建立
- [x] 建立 .NET 8 Web API 專案
- [x] 設定 NuGet 套件依賴 (Dapper, SSH.NET, Swashbuckle, Serilog)
- [x] 建立 `lib` 資料夾並設定 SAP NCo DLL 引用結構
- [x] 設定 `.vscode` 資料夾 (launch.json, tasks.json)
- [x] 設定 Serilog Rolling File 日誌

## Phase 2: 通用底層模組 (Infrastructure Layer)
- [x] 實作 `ISqlHelper` 介面與 `SqlHelper` 實作
- [x] 實作 `ISapHelper` 介面與 `SapHelper` 實作
- [x] 實作 `MockSapHelper` (Mock 機制)
- [x] 實作 `ISftpHelper` 介面與 `SftpHelper` 實作
- [x] 設定 DI Container 註冊

## Phase 3: 業務邏輯層 (Service Layer)
- [x] 建立 DTO Models (強型別契約)
- [x] 實作 `ICabinetExportService` 介面
- [x] 實作 `CabinetExportService` (整合流程編排)

## Phase 4: API Controller 層
- [x] 建立 `IntegrationController`
- [x] 實作 `POST /api/integration/cabinet-export` 端點
- [x] 設定 Swagger 文件

## Phase 5: 設定與文件
- [x] 完成 `appsettings.json` 配置 (連線字串、SAP 參數、Mock 開關)
- [x] 建立 Postman Collection
- [x] 撰寫開發者上手指南
- [x] 撰寫 IIS 部署手冊

## Phase 6: 驗證與測試
- [x] 本機 Mock 模式測試
- [x] Swagger UI 測試
- [x] 產出 swagger.json

## Phase 7: Hangfire 動態排程模組 (規格 v1.2 新增)
- [x] 安裝 Hangfire + Hangfire.SqlServer NuGet 套件
- [x] 建立 `App_ScheduleConfig` 資料表 Schema
- [x] 實作 `ScheduleSyncService` (IHostedService)
- [x] 實作 Cron Expression 格式驗證機制
- [x] 更新 Program.cs 加入 Hangfire 設定
- [x] 新增 Hangfire Dashboard 端點
- [x] 更新 appsettings.json 加入排程同步間隔設定
- [x] 更新部署手冊 (IIS AlwaysRunning 設定)
- [x] 編譯驗證成功
